<!-- 
    File: my-appointments.ejs
    Author: Brock Hemsouvanh
    Date: 12/13/23
    File Description: Page to display the appointments a customer has made. Uses a Node.js API. 
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles/site.css">
    <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,700;1,400&family=Nunito:ital,wght@0,300;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Pets-R-Us</title>
</head>
<body>
  <%- include('partials/header.ejs') %>

  <section class="container">
    <div class="card center-div">
        <div class="card-title">
            <h2>My Appointments</h2>
        </div>
  
        <form action="/lookup-appointments" method="post" class="form">
          <div class="form-field">
            <label for="email">Email Address</label><br />
            <input class="input" type="email" name="email" id="emailInput" placeholder="Enter your email address" required>
          </div>
          <div class="form-field">
            <button type="button" class="btn btn-primary full-width" onclick="lookupAppointments()">Look Up Appointments</button>
          </div>
        </form>
  
        <div id="appointmentResults"></div>
  
        <script>
          function lookupAppointments() {
            const email = document.getElementById('emailInput').value;
            fetch('/api/appointments/' + email)
              .then(response => response.json())
              .then(data => {
                let appointmentsHTML = "<table class='table'>";
                appointmentsHTML += "<tr><th>Service</th><th>Date</th></tr>";
                data.forEach(function(appointment) {
                  appointmentsHTML += `<tr><td>${appointment.service}</td><td>${appointment.date}</td></tr>`;
                });
                appointmentsHTML += "</table>";
                document.getElementById('appointmentResults').innerHTML = appointmentsHTML;
              })
              .catch(error => console.error('Error:', error));
          }
        </script>
        
        
    </div>
  </section>
  
  <%- include('partials/footer.ejs') %>
  

</body>
</html>

